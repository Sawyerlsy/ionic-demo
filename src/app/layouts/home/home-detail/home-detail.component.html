<ion-content>
    <ion-refresher slot="fixed" (ionRefresh)="refresh($event)">
        <ion-refresher-content pullingIcon="arrow-dropdown" pullingText="下拉刷新" refreshingSpinner="circles"
            refreshingText="正在刷新中...">
        </ion-refresher-content>
    </ion-refresher>
    <ion-slides pager="true" scrollbar="false" [options]="sliderOptions" (ionSlideTouchEnd)="ionSlideTouchEnd($event)"
        #banner>
        <ion-slide *ngFor="let slider of (imageSliders$ | async)">
            <img [src]="slider.imgUrl" [alt]="slider.caption" />
        </ion-slide>
    </ion-slides>

    <ng-container>
        <app-horizontal-grid>
            <span appGridItem *ngFor="let item of channels$ | async">
                <img appGridItemImage="2rem" [src]="item.icon" alt="" />
                <span appGridItemTitle="0.6rem" class="title">{{ item.title }}</span>
            </span>
        </app-horizontal-grid>
    </ng-container>

    <div class="ad-container" *ngIf="ad$ | async as ad">
        <img [src]="ad.imageUrl" alt="" class="ad-image" />
    </div>


    <div>
        <ion-refresher slot="fixed" (ionRefresh)="refresh($event)"
            *ngIf="!hasSelectedShop()&&(!page?true:page.total>0)">
            <ion-refresher-content pullingIcon="arrow-dropdown" pullingText="下拉刷新" refreshingSpinner="circles"
                refreshingText="正在刷新中...">
            </ion-refresher-content>
        </ion-refresher>

        <app-product-list [products]="products$ | async" [hasMore]="false" *ngIf="hasSelectedShop()" (selected)="handleSelectedProduct($event)">
        </app-product-list>
        <app-shop-list [shops]="shops" [hasMore]="!page?true:page.hasNext" *ngIf="!hasSelectedShop()" (selected)="handleSelectedShop($event)">
        </app-shop-list>

        <ion-infinite-scroll threshold="100px" (ionInfinite)="findMore($event)"
            *ngIf="!hasSelectedShop()&&(!page?true:page.hasNext)">
            <ion-infinite-scroll-content loadingSpinner="bubbles" loadingText="努力加载中...">
            </ion-infinite-scroll-content>
        </ion-infinite-scroll>
    </div>

</ion-content>